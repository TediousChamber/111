# PHP变量，常量

## 一、PHP变量

### 1. 什么是变量？

变量是用于存储数据的命名内存位置，其内容可以在程序运行期间改变。使用变量，可以方便地存储、修改和传递数据，使程序更加灵活和动态。

### 2. 变量的声明与命名规则

在PHP中，变量以美元符号 `$` 开头，后跟变量名。变量名的命名规则如下：

- 变量名必须以字母（A-Z，a-z）或下划线（_）开头，后面可以接任意数量的字母、数字或下划线。
- 变量名区分大小写，例如 `$name` 和 `$Name` 是两个不同的变量。
- 变量名不能包含空格，也不能使用PHP的保留关键字。

**示例：**



```php
<?php
$username = "张三";
$age = 25;
$isStudent = true;
?>
```

在上述示例中，定义了三个变量：`$username` 存储字符串“张三”，`$age` 存储整数25，`$isStudent` 存储布尔值 `true`。

### 3. 动态变量名

PHP支持动态变量名，即变量的变量。可以通过变量名字符串来引用变量。

**示例：**



```php
<?php
$varName = "score";
$$varName = 95; // 等同于 $score = 95;

echo $score; // 输出：95
?>
```

### 4.超全局变量与预定义变量

在PHP中，**超全局变量（Superglobal Variables）**和**预定义变量（Predefined Variables）**是**包含与被包含**的关系，但它们的核心性质不同，具体区别如下：

#### (1)**超全局变量**

- **定义**：以`$_`开头的特殊变量（如`$_GET`, `$_POST`, `$_SESSION`），在PHP初始化时自动创建。

- 特点

  ：

  - 在**任何作用域**（包括函数、类内部）中可直接访问。
  - 主要用于获取用户输入（如`$_GET`）、会话管理（如`$_SESSION`）、服务器环境（如`$_SERVER`）等。

- 常见列表

  ：

  ```php
  php复制代码
  
  $_GET, $_POST, $_COOKIE, $_SESSION, $_SERVER, $_FILES, $_REQUEST, $_ENV, $GLOBALS
  ```

#### (2) **预定义变量**

- **定义**：PHP自动创建的全局变量，包含超全局变量和其他特殊变量。

- 特点

  ：

  - 所有超全局变量属于预定义变量的一部分。
  - 其他预定义变量如`$GLOBALS`（包含所有全局变量）、`$argc`, `$argv`（命令行参数）等。

- 关键区别

  ：

  - **作用域**：超全局变量可在任何位置访问，但其他预定义变量（如`$GLOBALS`）需通过特定方式使用。
  - **用途**：超全局变量专注于外部数据交互，而`$GLOBALS`用于访问全局作用域变量。

#### （3）总结：

- **超全局变量 ⊂ 预定义变量**：超全局变量是预定义变量的一种特殊类型。

- 核心差异

  ：

  - 超全局变量以`$_`开头，专为外部数据交互设计。
  - 预定义变量范围更广，包含其他自动创建的变量（如`$GLOBALS`）。

#### （4）类比理解：

- **超全局变量** = 快递柜（专门存放外部包裹）。
- **预定义变量** = 整个仓库（包含快递柜和其他货架）。

因此，超全局变量是预定义变量中的特定子集，两者在作用域和用途上有明确区分。

## 二、PHP常量

### 1. 什么是常量？

常量是用于存储固定值的命名内存位置，在程序运行期间其值不会改变。常量通常用于存储配置信息、固定路径等不需要更改的数据。

### 2. 常量的定义与命名规则

在PHP中，可以使用 `define()` 函数或 `const` 关键字来定义常量。常量名同样遵循一定的命名规则，但无需使用 `$` 符号开头。

**使用 `define()` 函数定义常量：**

```php
<?php
define("PI", 3.14159);
define("APP_VERSION", "1.0.0");
?>
```

**使用 `const` 关键字定义常量：**

```php
<?php
const GREETING = "Hello, World!";
?>
```

**命名规则：**

- 常量名通常使用全大写字母和下划线分隔词，如 `APP_VERSION`，但这并不是强制的。
- 常量名不包含 `$` 符号。
- 常量名区分大小写。

### 3. 常量的特性

- **不可变性**：一旦定义了常量，其值无法被修改或重新定义。
- **无需引用符号**：使用常量时，不需要像变量那样使用 `$` 符号。
- **全局作用域**：常量在整个脚本中都是可使用的，无需担心作用域问题。

**示例：**

```php
<?php
define("MAX_USERS", 100);
echo MAX_USERS; // 输出：100

// 尝试修改常量值会导致错误
// define("MAX_USERS", 200); // 会产生一个致命错误
?>
```

### 4.魔术常量与预定义常量

#### （1）魔术常量

- 一些魔术常量会根据使用位置而变化。例如 **`__LINE__`** 的值取决于它在脚本中使用的行。所有这些“魔术”常量都在编译时解析，而常规常量则在运行时解析。这些特殊的常量不区分大小写，如下：

  

  | 名字                   | 说明                                                         |
  | :--------------------- | :----------------------------------------------------------- |
  | **`__LINE__`**         | 文件中的当前行号。                                           |
  | **`__FILE__`**         | 文件的完整路径和文件名。如果用在被包含文件中，则返回被包含的文件名。 |
  | **`__DIR__`**          | 文件所在的目录。如果用在被包括文件中，则返回被包括的文件所在的目录。它等价于 `dirname(__FILE__)`。除非是根目录，否则目录中名不包括末尾的斜杠。 |
  | **`__FUNCTION__`**     | 当前函数的名称。匿名函数则为 `{closure}`。                   |
  | **`__CLASS__`**        | 当前类的名称。类名包括其被声明的作用域（例如 `Foo\Bar`）。当用在 trait 方法中时，**`__CLASS__`** 是调用 trait 方法的类的名字。 |
  | **`__TRAIT__`**        | Trait 的名字。Trait 名包括其被声明的作用域（例如 `Foo\Bar`）。 |
  | **`__METHOD__`**       | 类的方法名。                                                 |
  | **`__PROPERTY__`**     | 仅在[属性挂钩](https://www.php.net/manual/zh/language.oop5.property-hooks.php)内有效。等同于属性的名称。 |
  | **`__NAMESPACE__`**    | 当前命名空间的名称。                                         |
  | **`ClassName::class`** | 完整的类名。                                                 |

**示例：**

```php
<?php
echo "当前行号: " . __LINE__ . "\n";
echo "当前文件: " . __FILE__ . "\n";
echo "PHP版本: " . PHP_VERSION . "\n";
?>
```

运行上述代码，可以输出当前代码的行号、文件路径以及PHP的版本信息。

#### （2）预定义常量

在PHP中，**预定义常量（Predefined Constants）**和**魔术常量（Magic Constants）**是**同一个概念**的不同表述方式，它们都指PHP内置的以双下划线（`__`）开头的特殊常量。这些常量由PHP引擎自动定义，提供与代码执行环境相关的动态信息。

#### （3）核心区别与联系：

1. 本质相同

   ：

   - 两者均属于PHP预定义的特殊常量，无需手动定义即可直接使用。

   - 官方文档中将它们统称为

     ![预定义常量](https://nlp-eb.cdn.bcebos.com/static/eb/asset/direct-link.c7a2d667.svg)

     预定义常量

     ，但开发者习惯将其中动态变化的（如

     ```
     __LINE__
     ```

     ）称为魔术常量，以强调其“魔法般”的自动更新特性。

2. 功能差异

   ：

   - 魔术常量

     ：值会随代码执行位置动态变化，例如：

     ```php
     echo __LINE__;   // 输出当前行号（如：5）
     echo __FILE__;   // 输出当前文件绝对路径（如：/var/www/test.php）
     echo __DIR__;    // 输出文件所在目录（如：/var/www）
     ```

   - 其他预定义常量

     ：值固定不变，如：

     ```php
     echo PHP_VERSION; // 输出PHP版本（如：8.2.6）
     echo PHP_OS;      // 输出操作系统类型（如：Linux）
     ```

3. 常见混淆点

   ：

   - **魔术方法（Magic Methods）**：如`__construct()`、`__get()`等，属于类中的特殊方法，与常量无关，但名称中同样含双下划线，容易混淆。

#### （4）总结：

- **预定义常量 = 魔术常量 + 其他固定常量**。
- 若特指动态变化的常量（如行号、文件名），可称“魔术常量”；若泛指所有内置常量，则称“预定义常量”。两者本质相同，只是使用场景下的细分称呼差异。